# 品才AI学习官 - 项目需求与实现文档

## 项目概述

**项目名称**：品才AI学习官（AI Coach MVP）  
**项目目标**：为品才集团打造一套智能业务员实战陪练系统，通过 AI 模拟客户对话，帮助销售人员提升谈单能力。

**在线地址**：https://ai-coach-mvp.vercel.app  
**GitHub 仓库**：https://github.com/michellelmintzb33-alt/ai-coach-mvp

---

## 核心需求与实现

### 1. 六大实战训练关卡

| 关卡 | 名称 | 难度 | 训练要点 |
|------|------|------|----------|
| 第1关 | 初次咨询 | ★☆☆☆☆ | HRO价值定义、三支柱、专业术语 |
| 第2关 | 价格异议 | ★★★☆☆ | 附加税逻辑(0.72%)、进项抵扣、低价应对 |
| 第3关 | 合规安全 | ★★★☆☆ | 资金安全、三流统一、社保审计 |
| 第4关 | 理赔实战 | ★★★★☆ | 工伤备案时效(24H)、责任划分、理赔材料 |
| 第5关 | 劳动法博弈 | ★★★★☆ | N/N+1/2N补偿金、解除条件、仲裁风险 |
| 第6关 | 大客户谈判 | ★★★★★ | 品牌内核、行业背书、服务标准 |

---

### 2. AI 对话引擎

#### 2.1 动态随机开场白
- **需求**：每次进入关卡看到不同的开场问题，避免背题库
- **实现**：
  - 本地随机库：每关预设 5-8 条上海本地化开场白
  - AI 动态生成：调用 Gemini 模型实时生成随机场景
  - 双保险机制：API 成功用 AI，失败用本地随机

#### 2.2 地域与行业设定
- **需求**：地点锁定上海，行业不限制
- **实现**：
  - 上海 12 个标志性区域：张江、漕河泾、陆家嘴、闵行、嘉定等
  - 10+ 行业随机：芯片、电商、制药、物流、餐饮等

#### 2.3 场景话题隔离
- **需求**：不同关卡的问题边界清晰，不能串台
- **实现**：
  - 每个场景配置【话题禁区】
  - System Prompt 强制约束话题范围
  - 场景专属 Fallback 响应库

---

### 3. AI 响应优化

#### 3.1 语义承接
- **需求**：AI 必须先回应用户的问题，不能自说自话
- **实现**：
  - Prompt 规则："语义承接优先"
  - 强制 AI 先评价/回答用户输入，再提问
  - 确认理解机制

#### 3.2 话题切换支持
- **需求**：用户换话题时，AI 立即跟随
- **实现**：
  - Prompt 规则："话题切换检测"
  - 禁止说"先把之前的问题说完"

---

### 4. 评分系统

#### 4.1 严格评分机制
- **基础分**：20 分起步
- **敷衍重罚**：回复"啊？"、"不知道"等直接降至 10 分
- **关键词加分**：命中业务关键词可获得 10-20 分加成
- **长度与态度**：回复超过 30 字、使用专业用语可加分

#### 4.2 评估等级
| 分数范围 | 等级 | 评价 |
|----------|------|------|
| 0-30 | 被拒绝 | 回答过于随意或不符合业务常识 |
| 31-50 | 职场小白 | 回答浮于表面，缺乏实战细节 |
| 51-75 | 业务能手 | 基本能抓住痛点，说服力还不够 |
| 76-90 | 资深精英 | 逻辑性强，能捕捉客户心理 |
| 91-100 | 销冠大师 | 教科书般的回答 |

---

### 5. 对话持久化

- **需求**：对话历史不丢失，用户返回可继续
- **实现**：
  - localStorage 自动保存对话记录
  - "继续上次对话"按钮
  - 一键恢复关卡、消息、策略模式

---

### 6. 对话策略模式

- **线性解决模式**：按照逻辑闭环推进（发现问题→分析→方案→共识）
- **随机了解模式**：从多维度随机提问，了解服务方底线

---

## 技术架构

### 前端
- **框架**：Next.js 14 (App Router)
- **样式**：CSS Modules
- **状态管理**：React useState/useEffect
- **持久化**：localStorage

### 后端
- **API 路由**：Next.js API Routes
- **AI 模型**：Gemini 2.0 Flash Exp
- **数据库**：Supabase (PostgreSQL + pgvector)

### 部署
- **托管**：Vercel
- **代码仓库**：GitHub

---

## 环境变量

| 变量名 | 用途 |
|--------|------|
| `GEMINI_API_KEY` | Google Gemini API 密钥 |
| `NEXT_PUBLIC_SUPABASE_URL` | Supabase 项目 URL |
| `NEXT_PUBLIC_SUPABASE_ANON_KEY` | Supabase 匿名密钥 |

---

## 文件结构

```
ai-coach-mvp/
├── app/
│   ├── api/chat/route.js      # AI 对话 API
│   ├── lib/
│   │   ├── scenarios.js       # 关卡配置与评分逻辑
│   │   └── supabase.js        # 数据库连接
│   ├── page.js                # 主页面组件
│   └── page.module.css        # 样式文件
├── .env.local                 # 环境变量
└── package.json
```

---

## 版本历史

| 日期 | 版本 | 更新内容 |
|------|------|----------|
| 2026-01-19 | v1.0 | MVP 发布：6关卡、AI对话、评分系统 |
| 2026-01-19 | v1.1 | 动态随机开场白、场景隔离、评分优化 |
| 2026-01-19 | v1.2 | 对话持久化、AI响应优化、话题切换支持 |
| 2026-01-19 | v1.3 | 升级到 Gemini 2.0 Flash 模型 |

---

## 待办事项

- [ ] 获取有效的 Gemini API Key 测试完整功能
- [ ] 管理后台（添加/编辑话术）
- [ ] 用户进度追踪与排行榜
- [ ] RAG 知识库深度集成
